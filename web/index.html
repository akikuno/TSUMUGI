<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TSUMUGI</title>
    <link rel="icon" type="image/png" href="image/icon-tsumugi.png">
    <link href='https://fonts.googleapis.com/css?family=Lora' rel='stylesheet'>
    <link href="https://use.fontawesome.com/releases/v6.6.0/css/all.css" rel="stylesheet">
    <!-- <link href='https://fonts.googleapis.com/css?family=Macondo' rel='stylesheet'> -->
    <!-- <link href='https://fonts.googleapis.com/css?family=Merriweather' rel='stylesheet'> -->
    <link href='https://fonts.googleapis.com/css?family=Lato' rel='stylesheet'>
    <style>
        body {
            font-family: 'Lato', 'Arial', 'Helvetica', sans-serif;
            background-color: #FFEBD8;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            height: 100vh;
        }

        p.subtitle {
            font-family: 'Lora', serif;
            font-size: 1.2em;
            margin-bottom: 20px;
            color: #333;
            text-align: center;
        }

        form {
            background-color: #fff;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            max-width: 400px;
            width: 100%;
            margin-top: 20px;
            margin-bottom: 20px;
        }

        label {
            font-size: 1.2em;
            margin-bottom: 10px;
            display: block;
            color: #555;
        }

        input[type="text"] {
            width: 100%;
            padding: 10px;
            font-size: 1em;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin-bottom: 20px;
            box-sizing: border-box;
            font-family: 'Lato', 'Arial', 'Helvetica', sans-serif;
        }

        ul.suggestions {
            list-style-type: none;
            padding: 0;
            margin: 0;
            border: 1px solid #ccc;
            border-radius: 5px;
            max-height: 150px;
            overflow-y: auto;
        }

        ul.suggestions li {
            padding: 10px;
            cursor: pointer;
            background-color: #fff;
        }

        ul.suggestions li:hover {
            background-color: #f0f0f0;
        }

        button {
            margin-top: 20px;
            padding: 12px 20px;
            font-size: 1em;
            color: #fff;
            background-color: #ff7800;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-family: 'Lato', 'Arial', 'Helvetica', sans-serif;
        }

        button:disabled {
            background-color: #999;
            cursor: not-allowed;
        }

        button:hover:enabled {
            background-color: #ff7800;
        }

        footer {
            text-align: center;
            margin-top: auto;
            margin-bottom: 10px;
            padding: 20px;
            width: 100%;
        }

        footer a {
            margin: 0 10px;
            color: #333;
            text-decoration: none;
            font-weight: bold;
        }

        footer a:hover {
            text-decoration: underline;
        }

        footer p {
            margin: 5px 0 0;
            font-size: 0.9em;
            color: #666;
        }

        img {
            width: 100%;
            height: auto;
            max-width: 100%;
            display: block;
            margin: 0 auto;
        }
    </style>
</head>

<body>
    <form id="phenotypeForm">
        <img src="image/tsumugi-logo.png" alt="TSUMUGI">
        <p class="subtitle">Trait-driven Surveillance for Mutation-based Gene module Identification</p>
        <label for="phenotype">Choose a phenotype of your interest</label>
        <input type="text" id="phenotype" name="phenotype" placeholder="e.g: infertility">
        <ul id="suggestions" class="suggestions"></ul>
        <button type="submit" id="submitBtn" disabled>Submit</button>
    </form>

    <footer>
        <i class="fa-brands fa-github"></i><a href="https://example.com/" target="_blank">GitHub</a>
        <i class="fa-regular fa-newspaper"></i><a href="https://example.com" target="_blank">Article</a>
        <p><i class="fa-regular fa-envelope"></i> akuno[at]md.tsukuba.ac.jp</p>
        <p>&copy; 2024 Laboratory Animal Resource Center, University of Tsukuba</p>
    </footer>

    <script>
        const phenotypes = [
            "Abnormal abdominal wall morphology",
            "Abnormal adrenal gland morphology",
            "Abnormal allantois morphology",
            "Abnormal anxiety-related response",
            "Abnormal auditory brainstem response",
            "Abnormal autopod morphology",
            "Abnormal behavior",
            "Abnormal blood vessel morphology",
            "Abnormal body wall morphology",
            "Abnormal bone mineralization",
            "Abnormal bone structure",
            "Abnormal brain morphology",
            "Abnormal caudal vertebrae morphology",
            "Abnormal cecum morphology",
            "Abnormal cholesterol homeostasis",
            "Abnormal chorioallantoic fusion",
            "Abnormal clavicle morphology",
            "Abnormal coat appearance",
            "Abnormal coat hair pigmentation",
            "Abnormal coat  hair morphology",
            "Abnormal colon morphology",
            "Abnormal contextual conditioning behavior",
            "Abnormal cornea morphology",
            "Abnormal craniofacial morphology",
            "Abnormal cranium morphology",
            "Abnormal cued conditioning behavior",
            "Abnormal defecation",
            "Abnormal digit morphology",
            "Abnormal duodenum morphology",
            "Abnormal ear morphology",
            "Abnormal embryo development",
            "Abnormal embryo size",
            "Abnormal embryo turning",
            "Abnormal epididymis morphology",
            "Abnormal erythrocyte cell number",
            "Abnormal esophagus morphology",
            "Abnormal eyelid aperture",
            "Abnormal eyelid fusion",
            "Abnormal eyelid morphology",
            "Abnormal eye anterior chamber depth",
            "Abnormal eye morphology",
            "Abnormal eye pigmentation",
            "Abnormal eye posterior chamber depth",
            "Abnormal eye size",
            "Abnormal facial morphology",
            "Abnormal femur morphology",
            "Abnormal fibula morphology",
            "Abnormal forebrain development",
            "Abnormal forebrain morphology",
            "Abnormal forelimb morphology",
            "Abnormal freezing behavior",
            "Abnormal gait",
            "Abnormal gallbladder morphology",
            "Abnormal head morphology",
            "Abnormal head shape",
            "Abnormal head size",
            "Abnormal heart left ventricle morphology",
            "Abnormal heart looping",
            "Abnormal heart morphology",
            "Abnormal heart shape",
            "Abnormal heart weight",
            "Abnormal hematocrit",
            "Abnormal hemoglobin content",
            "Abnormal hindbrain development",
            "Abnormal hindbrain morphology",
            "Abnormal hindlimb morphology",
            "Abnormal humerus morphology",
            "Abnormal incisor color",
            "Abnormal incisor morphology",
            "Abnormal inspiratory capacity",
            "Abnormal iris morphology",
            "Abnormal iris pigmentation",
            "Abnormal jejunum morphology",
            "Abnormal joint morphology",
            "Abnormal kidney morphology",
            "Abnormal left-right axis patterning",
            "Abnormal lens morphology",
            "Abnormal limb bud morphology",
            "Abnormal limb morphology",
            "Abnormal liver morphology",
            "Abnormal liver size",
            "Abnormal locomotor activation",
            "Abnormal locomotor behavior",
            "Abnormal lumbar vertebrae morphology",
            "Abnormal lung morphology",
            "Abnormal lymph node morphology",
            "Abnormal male genitalia morphology",
            "Abnormal mammary gland morphology",
            "Abnormal mandible morphology",
            "Abnormal maxilla morphology",
            "Abnormal mean corpuscular hemoglobin",
            "Abnormal mean corpuscular volume",
            "Abnormal midbrain development",
            "Abnormal midbrain morphology",
            "Abnormal motor capabilities coordination movement",
            "Abnormal motor coordination balance",
            "Abnormal mouth morphology",
            "Abnormal nail morphology",
            "Abnormal neural tube closure",
            "Abnormal neural tube morphology",
            "Abnormal optic disk morphology",
            "Abnormal optic vesicle formation",
            "Abnormal otic vesicle morphology",
            "Abnormal outer ear morphology",
            "Abnormal ovary morphology",
            "Abnormal pancreas morphology",
            "Abnormal pelvic girdle bone morphology",
            "Abnormal pericardium morphology",
            "Abnormal pharyngeal arch morphology",
            "Abnormal placement of pupils",
            "Abnormal placenta development",
            "Abnormal placenta morphology",
            "Abnormal placenta size",
            "Abnormal placenta vasculature",
            "Abnormal pupil morphology",
            "Abnormal QT variability",
            "Abnormal radius morphology",
            "Abnormal red blood cell distribution width",
            "Abnormal response to new environment",
            "Abnormal response to tactile stimuli",
            "Abnormal retina blood vessel morphology",
            "Abnormal retina blood vessel pattern",
            "Abnormal retina inner nuclear layer morphology",
            "Abnormal retina morphology",
            "Abnormal retina outer nuclear layer morphology",
            "Abnormal retina pigmentation",
            "Abnormal retina vasculature morphology",
            "Abnormal rib morphology",
            "Abnormal sacral vertebrae morphology",
            "Abnormal scapula morphology",
            "Abnormal seminal vesicle morphology",
            "Abnormal sinus arrhythmia",
            "Abnormal skeletal muscle morphology",
            "Abnormal skin appearance",
            "Abnormal skin coloration",
            "Abnormal skin morphology",
            "Abnormal skin pigmentation",
            "Abnormal sleep behavior",
            "Abnormal snout morphology",
            "Abnormal somite shape",
            "Abnormal spinal cord morphology",
            "Abnormal spine curvature",
            "Abnormal spleen morphology",
            "Abnormal startle reflex",
            "Abnormal sternum morphology",
            "Abnormal stomach morphology",
            "Abnormal tail bud morphology",
            "Abnormal tail length",
            "Abnormal tail morphology",
            "Abnormal tail movements",
            "Abnormal testis morphology",
            "Abnormal thoracic cage shape",
            "Abnormal thymus morphology",
            "Abnormal thyroid gland morphology",
            "Abnormal tibia morphology",
            "Abnormal tooth color",
            "Abnormal tooth morphology",
            "Abnormal trachea morphology",
            "Abnormal ulna morphology",
            "Abnormal urinary bladder morphology",
            "Abnormal urination",
            "Abnormal uterus morphology",
            "Abnormal vertebrae morphology",
            "Abnormal vertebral arch morphology",
            "Abnormal vibrissa morphology",
            "Abnormal visceral yolk sac morphology",
            "Abnormal vitelline vasculature morphology",
            "Abnormal vitreous body morphology",
            "Abnormal vocalization",
            "Abnormal whole-body plethysmography",
            "Abnormal zygomatic bone morphology",
            "Absent adrenal gland",
            "Absent epididymis",
            "Absent external male genitalia",
            "Absent lymph nodes",
            "Absent optic nerve",
            "Absent pinna reflex",
            "Absent seminal vesicle",
            "Absent teeth",
            "Absent vibrissae",
            "Anophthalmia",
            "Aorta stenosis",
            "Bleb",
            "Blind uterus",
            "Brachydactyly",
            "Cardiovascular system phenotype",
            "Cataract",
            "Cleft palate",
            "Convulsive seizures",
            "Corneal deposits",
            "Corneal opacity",
            "Corneal vascularization",
            "Curly tail",
            "Cyanosis",
            "Cystolithiasis",
            "Decreased anxiety-related response",
            "Decreased blood urea nitrogen level",
            "Decreased body length",
            "Decreased body temperature",
            "Decreased body weight",
            "Decreased bone mineral content",
            "Decreased bone mineral density",
            "Decreased bone trabecula number",
            "Decreased brain size",
            "Decreased brain weight",
            "Decreased bronchoconstrictive response",
            "Decreased B cell number",
            "Decreased cardiac muscle contractility",
            "Decreased cardiac output",
            "Decreased cardiac stroke volume",
            "Decreased caudal vertebrae number",
            "Decreased CD4-negative NK T cell number",
            "Decreased CD4-positive, alpha-beta T cell number",
            "Decreased CD4-positive, CD25-positive, alpha-beta regulatory T cell number",
            "Decreased CD4-positive NK T cell number",
            "Decreased CD5-positive Ly6C-positive T cell number",
            "Decreased CD8-positive, alpha-beta T cell number",
            "Decreased CD8-positive, naive alpha-beta T cell number",
            "Decreased circulating alanine transaminase level",
            "Decreased circulating alkaline phosphatase level",
            "Decreased circulating amylase level",
            "Decreased circulating aspartate transaminase level",
            "Decreased circulating bilirubin level",
            "Decreased circulating calcium level",
            "Decreased circulating chloride level",
            "Decreased circulating cholesterol level",
            "Decreased circulating creatinine level",
            "Decreased circulating free fatty acids level",
            "Decreased circulating fructosamine level",
            "Decreased circulating glucose level",
            "Decreased circulating glycerol level",
            "Decreased circulating HDL cholesterol level",
            "Decreased circulating iron level",
            "Decreased circulating LDL cholesterol level",
            "Decreased circulating magnesium level",
            "Decreased circulating phosphate level",
            "Decreased circulating potassium level",
            "Decreased circulating serum albumin level",
            "Decreased circulating sodium level",
            "Decreased circulating total protein level",
            "Decreased circulating triglyceride level",
            "Decreased coping response",
            "Decreased defecation amount",
            "Decreased effector memory CD8-positive, alpha-beta T cell number",
            "Decreased effector memory T-helper cell number",
            "Decreased eosinophil cell number",
            "Decreased erythrocyte cell number",
            "Decreased exploration in new environment",
            "Decreased fasting circulating glucose level",
            "Decreased food intake",
            "Decreased grip strength",
            "Decreased heart left ventricle size",
            "Decreased heart rate",
            "Decreased heart rate variability",
            "Decreased heart weight",
            "Decreased hematocrit",
            "Decreased hemoglobin content",
            "Decreased kidney weight",
            "Decreased large unstained cell number",
            "Decreased lean body mass",
            "Decreased leukocyte cell number",
            "Decreased liver weight",
            "Decreased locomotor activity",
            "Decreased lung elastance",
            "Decreased Ly6C-positive immature NK cell number",
            "Decreased Ly6C-positive mature NK cell number",
            "Decreased lymphocyte cell number",
            "Decreased mature B cell number",
            "Decreased mean corpuscular hemoglobin",
            "Decreased mean corpuscular hemoglobin concentration",
            "Decreased mean corpuscular volume",
            "Decreased mean platelet volume",
            "Decreased memory-marker CD4-negative NK T cell number",
            "Decreased memory-marker CD4-positive NK T cell number",
            "Decreased monocyte cell number",
            "Decreased neutrophil cell number",
            "Decreased NK cell number",
            "Decreased NK T cell number",
            "Decreased prepulse inhibition",
            "Decreased pulmonary ventilation",
            "Decreased red blood cell distribution width",
            "Decreased respiratory quotient",
            "Decreased sacral vertebrae number",
            "Decreased spleen weight",
            "Decreased startle reflex",
            "Decreased T-helper cell number",
            "Decreased thigmotaxis",
            "Decreased thymus weight",
            "Decreased total body fat amount",
            "Decreased total retina thickness",
            "Decreased T cell number",
            "Decreased urine creatinine level",
            "Decreased urine magnesium level",
            "Decreased vertical activity",
            "Dilated heart left ventricle",
            "Distended jejunum",
            "Edema",
            "Embryonic growth retardation",
            "Embryonic lethality prior to organogenesis",
            "Embryonic lethality prior to tooth bud stage",
            "Enhanced contextual conditioning behavior",
            "Enhanced cued conditioning behavior",
            "Enlarged adrenal glands",
            "Enlarged cecum",
            "Enlarged epididymis",
            "Enlarged gallbladder",
            "Enlarged heart",
            "Enlarged kidney",
            "Enlarged liver",
            "Enlarged lymph nodes",
            "Enlarged prostate gland",
            "Enlarged seminal vesicle",
            "Enlarged spleen",
            "Enlarged stomach",
            "Enlarged testis",
            "Enlarged thymus",
            "Enlarged urinary bladder",
            "Enlarged uterus",
            "Exencephaly",
            "Eyelids fail to open",
            "Eye hemorrhage",
            "Facial cleft",
            "Female infertility",
            "Fused cornea and lens",
            "Fused phalanges",
            "Fusion of vertebral arches",
            "Head bobbing",
            "Hemorrhage",
            "Hydrocephaly",
            "Hydrometra",
            "Hyperactivity",
            "Immune system phenotype",
            "Impaired contextual conditioning behavior",
            "Impaired cued conditioning behavior",
            "Impaired glucose tolerance",
            "Impaired pupillary reflex",
            "Impaired righting response",
            "Improved glucose tolerance",
            "Increased aggression",
            "Increased airway resistance",
            "Increased anxiety-related response",
            "Increased basophil cell number",
            "Increased blood urea nitrogen level",
            "Increased body length",
            "Increased body weight",
            "Increased bone mineral content",
            "Increased bone mineral density",
            "Increased bone trabecular spacing",
            "Increased brain size",
            "Increased B cell number",
            "Increased cardiac muscle contractility",
            "Increased cardiac stroke volume",
            "Increased CD4-positive, alpha-beta T cell number",
            "Increased CD4-positive, CD25-positive, alpha-beta regulatory T cell number",
            "Increased CD4-positive NK T cell number",
            "Increased CD8-positive, alpha-beta T cell number",
            "Increased CD8-positive, naive alpha-beta T cell number",
            "Increased circulating alanine transaminase level",
            "Increased circulating alkaline phosphatase level",
            "Increased circulating amylase level",
            "Increased circulating aspartate transaminase level",
            "Increased circulating bilirubin level",
            "Increased circulating calcium level",
            "Increased circulating chloride level",
            "Increased circulating cholesterol level",
            "Increased circulating creatine kinase level",
            "Increased circulating creatinine level",
            "Increased circulating free fatty acids level",
            "Increased circulating fructosamine level",
            "Increased circulating glucose level",
            "Increased circulating glycerol level",
            "Increased circulating HDL cholesterol level",
            "Increased circulating insulin level",
            "Increased circulating iron level",
            "Increased circulating lactate dehydrogenase level",
            "Increased circulating LDL cholesterol level",
            "Increased circulating lipase level",
            "Increased circulating magnesium level",
            "Increased circulating phosphate level",
            "Increased circulating potassium level",
            "Increased circulating serum albumin level",
            "Increased circulating sodium level",
            "Increased circulating total protein level",
            "Increased circulating triglyceride level",
            "Increased circulating unsaturated transferrin level",
            "Increased coping response",
            "Increased cornea thickness",
            "Increased effector memory CD8-positive, alpha-beta T cell number",
            "Increased effector memory T-helper cell number",
            "Increased eosinophil cell number",
            "Increased erythrocyte cell number",
            "Increased exploration in new environment",
            "Increased fasting circulating glucose level",
            "Increased fluid intake",
            "Increased food intake",
            "Increased freezing behavior",
            "Increased granulocyte number",
            "Increased grip strength",
            "Increased heart left ventricle size",
            "Increased heart rate",
            "Increased heart rate variability",
            "Increased heart weight",
            "Increased hematocrit",
            "Increased hemoglobin content",
            "Increased IgG3 level",
            "Increased kidney weight",
            "Increased lactate dehydrogenase level",
            "Increased large unstained cell number",
            "Increased lean body mass",
            "Increased leukocyte cell number",
            "Increased liver weight",
            "Increased lung compliance",
            "Increased lung elastance",
            "Increased lung tissue damping",
            "Increased Ly6C-positive mature NK cell number",
            "Increased lymphocyte cell number",
            "Increased mean corpuscular hemoglobin",
            "Increased mean corpuscular hemoglobin concentration",
            "Increased mean corpuscular volume",
            "Increased mean platelet volume",
            "Increased memory-marker CD4-positive NK T cell number",
            "Increased monocyte cell number",
            "Increased neutrophil cell number",
            "Increased NK cell number",
            "Increased NK T cell number",
            "Increased prepulse inhibition",
            "Increased pulmonary respiratory rate",
            "Increased pulmonary ventilation",
            "Increased red blood cell distribution width",
            "Increased respiratory quotient",
            "Increased spleen weight",
            "Increased startle reflex",
            "Increased T-helper cell number",
            "Increased thermal nociceptive threshold",
            "Increased thigmotaxis",
            "Increased total body fat amount",
            "Increased total retina thickness",
            "Increased T cell number",
            "Increased urine microalbumin level",
            "Increased vertical activity",
            "Iris synechia",
            "Irregularly shaped pupil",
            "Kinked tail",
            "Kyphosis",
            "Limb grasping",
            "Long tibia",
            "Lordosis",
            "Male infertility",
            "Microcephaly",
            "Microphthalmia",
            "Mydriasis",
            "Narrow eye opening",
            "No spontaneous movement",
            "Pale liver",
            "Pale yolk sac",
            "Pallor",
            "Persistence of hyaloid vascular system",
            "Polycystic kidney",
            "Polydactyly",
            "Polysyndactyly",
            "Prenatal lethality",
            "Prenatal lethality prior to heart atrial septation",
            "Preweaning lethality, complete penetrance",
            "Preweaning lethality, incomplete penetrance",
            "Prolonged PR interval",
            "Prolonged QRS complex duration",
            "Prolonged QT interval",
            "Prolonged RR interval",
            "Prolonged ST segment",
            "Protruding tongue",
            "Respiratory system phenotype",
            "Rib fusion",
            "Sclerocornea",
            "Scoliosis",
            "Shortened PQ interval",
            "Shortened PR interval",
            "Shortened QRS complex duration",
            "Shortened QT interval",
            "Shortened RR interval",
            "Shortened ST segment",
            "Short tail",
            "Short tibia",
            "Single kidney",
            "Small adrenal glands",
            "Small epididymis",
            "Small heart",
            "Small kidney",
            "Small liver",
            "Small lung",
            "Small ovary",
            "Small seminal vesicle",
            "Small spleen",
            "Small stomach",
            "Small testis",
            "Small thymus",
            "Small uterus",
            "Spina bifida",
            "Stereotypic behavior",
            "Syndactyly",
            "Thick skin",
            "Thick ventricular wall",
            "Thin ventricular wall",
            "Thrombocytopenia",
            "Thrombocytosis",
            "Tremors",
            "Trunk curl",
            "Unresponsive to tactile stimuli",
            "Urinary bladder obstruction",
            "Vertebral fusion",
            "Vertebral transformation",

        ];

        const input = document.getElementById('phenotype');
        const suggestions = document.getElementById('suggestions');
        const submitBtn = document.getElementById('submitBtn');


        function jaroWinkler(s1, s2) {
            const m = 0.1;
            const scalingFactor = 0.1;
            const s1Len = s1.length;
            const s2Len = s2.length;

            if (s1Len === 0 || s2Len === 0) return 0;

            const matchWindow = Math.floor(Math.max(s1Len, s2Len) / 2) - 1;
            const s1Matches = new Array(s1Len).fill(false);
            const s2Matches = new Array(s2Len).fill(false);
            let matches = 0;

            for (let i = 0; i < s1Len; i++) {
                const start = Math.max(0, i - matchWindow);
                const end = Math.min(i + matchWindow + 1, s2Len);

                for (let j = start; j < end; j++) {
                    if (s2Matches[j]) continue;
                    if (s1[i] !== s2[j]) continue;
                    s1Matches[i] = true;
                    s2Matches[j] = true;
                    matches++;
                    break;
                }
            }

            if (matches === 0) return 0;

            let transpositions = 0;
            let k = 0;

            for (let i = 0; i < s1Len; i++) {
                if (!s1Matches[i]) continue;
                while (!s2Matches[k]) k++;
                if (s1[i] !== s2[k]) transpositions++;
                k++;
            }

            transpositions /= 2;

            const jaroScore = ((matches / s1Len) + (matches / s2Len) + ((matches - transpositions) / matches)) / 3;

            let prefixLength = 0;
            for (let i = 0; i < Math.min(4, s1Len, s2Len); i++) {
                if (s1[i] === s2[i]) prefixLength++;
                else break;
            }

            return jaroScore + (prefixLength * scalingFactor * (1 - jaroScore));
        }

        function wordMatchScore(input, phenotype) {
            const inputWords = input.split(' ').filter(Boolean);
            const phenotypeWords = phenotype.split(' ').filter(Boolean);
            let score = 0;

            inputWords.forEach(inputWord => {
                let maxScore = 0;
                phenotypeWords.forEach(phenotypeWord => {
                    const similarity = jaroWinkler(inputWord.toLowerCase(), phenotypeWord.toLowerCase());
                    maxScore = Math.max(maxScore, similarity);
                });

                score += maxScore;  // そのまま最大の類似度スコアを加算
            });

            return score;
        }

        input.addEventListener('input', function () {
            const query = input.value.toLowerCase();
            suggestions.innerHTML = '';
            let validInput = false;

            if (query) {
                const filtered = phenotypes
                    .map(phenotype => {
                        return {
                            text: phenotype,
                            score: wordMatchScore(query, phenotype)
                        };
                    })
                    .sort((a, b) => b.score - a.score) // スコアが高い順にソート
                    .filter(item => item.score > 0) // スコアが0より大きいものだけを表示
                    .slice(0, 10); // 上位10件を表示

                filtered.forEach(function (item) {
                    const li = document.createElement('li');
                    li.textContent = item.text;
                    li.addEventListener('click', function () {
                        input.value = item.text;
                        suggestions.innerHTML = '';
                        checkValidInput();
                    });
                    suggestions.appendChild(li);
                });

                validInput = filtered.some(function (item) {
                    return item.text.toLowerCase() === query;
                });
            }

            submitBtn.disabled = !validInput;
        });

        input.addEventListener('blur', checkValidInput);

        function checkValidInput() {
            const isValid = phenotypes.includes(input.value);
            submitBtn.disabled = !isValid;
        }

        document.getElementById('phenotypeForm').addEventListener('submit', function (event) {
            event.preventDefault();
            if (!submitBtn.disabled) {
                const selectedPhenotype = input.value.replace(/\s+/g, '_').toLowerCase();
                window.open(`network/${selectedPhenotype}.html`, '_blank');
            }
        });
    </script>
</body>

</html>
